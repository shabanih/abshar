<!DOCTYPE html>
{% load poll_extras %}
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>صورتحساب شارژ کل واحدها </title>
    <style>
        body {
            font-family: 'Vazir', sans-serif;
            direction: rtl;
            font-size: 13px;
            line-height: 2;
        }
        .invoice-box {
            padding: 10px;
            border: 2px solid #0c0c0c;
            margin-bottom: 20px;
        }
        .invoice-box h2{
            font-weight: bold;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            text-align: center;
        }
        p{
            font-size: 12px;
        }
        th, td {
            font-family: Vazir, sans-serif;
            padding: 2px;
            border: 1px solid #ccc;
        }
        th {
            background-color: #eee;
        }
        .total {
            background-color: #f9f9f9;
            font-weight: bold;
        }
        .text-center {
            text-align: center;
        }
    </style>
</head>
<body>

{% for charge in charges %}

   <div class="invoice-box">
         <h3 class="text-center font-weight-bold">مجتمع مسکونی {{ house.name }}</h3>

        <h2 class="text-center font-weight-bold">صورتحساب {{ charge.title }}</h2>
    <table>
        <tr>
            <th>واحد</th>
            <th>نام مالک/مستاجر</th>
            <th>متراژ</th>
            <th>تعداد نفرات</th>
        </tr>
        <tr>
            <td>{{ charge.unit.unit }} </td>
            <td>{{ charge.user.full_name }}</td>
            <td>{{ charge.unit.area }}</td>
            <td>{{ charge.unit.people_count }}</td>
        </tr>
    </table>

    <table>
        <tr>
            <th>تاریخ صدور</th>
            <th>مهلت پرداخت</th>
        </tr>
        <tr>
            <td> {{ charge.send_notification_date|show_jalali_date_only }} </td>
            <td>{{ charge.payment_deadline_date|show_jalali_date_only }}</td>
        </tr>
    </table>

    <table>
        <tr>
            <th>شرح</th>
            <th>مبلغ (تومان)</th>
        </tr>
        <tr>
            <td>شارژ ماهیانه واحد</td>
            <td>
                {% if charge.charge_type == 'fixed' %}
                    {{ charge.related_object.amount|three_digit_currency }}
                {% elif charge.charge_type == 'area' %}
                    {{ charge.related_object.final_area_amount|three_digit_currency }}
                {% elif charge.charge_type == 'person' %}
                    {{ charge.related_object.final_person_amount|three_digit_currency }}
                {% elif charge.charge_type == 'fix_area' %}
                    {{ charge.related_object.final_person_amount|three_digit_currency }}
                {% elif charge.charge_type == 'fix_person' %}
                    {{ charge.related_object.final_person_amount|three_digit_currency }}
                {% elif charge.charge_type == 'person_area' %}
                    {{ charge.related_object.final_person_amount|three_digit_currency }}
                {% elif charge.charge_type == 'fix_person_area' %}
                    {{ charge.related_object.final_person_amount|three_digit_currency }}
                {% elif charge.charge_type == 'fix_variable' %}
                    {{ charge.related_object.final_person_amount|three_digit_currency }}
                {% endif %}
            </td>
        </tr>
        <tr>
            <td>شارژ عمرانی</td>
            <td>{{ charge.civil|three_digit_currency }}</td>
        </tr>
        <tr>
            {% if charge.charge_type == 'fix_variable' %}
                <td>اجاره پارکینگ اضافه ({{ charge.related_object.parking_count }})</td>
                <td>{{ charge.related_object.extra_parking_charges|three_digit_currency }}</td>
            {% endif %}
        </tr>
        <tr>
            <td>سایر هزینه‌ها</td>
            <td>{{ charge.other_cost_amount|three_digit_currency }}</td>
        </tr>
        <tr>
            <td>جریمه دیرکرد</td>
            <td>{{ charge.penalty_amount|three_digit_currency }}</td>
        </tr>
        <tr class="total">
            <td colspan="1">جمع کل قابل پرداخت</td>
            <td>{{ charge.total_charge_month|three_digit_currency }}</td>
        </tr>
    </table>

    <table style="width: 100%; border: none; font-size: 13px; line-height: 1.8;">
        <tr>
            <td style="text-align: center; direction: rtl; margin: 10px; padding: 10px">
                {% if bank %}
                    <p style="font-family: Vazir, sans-serif">
                        خواهشمند است مبلغ شارژ را به شماره حساب
                        <strong>{{ bank.account_no }}</strong>
                        نزد بانک
                        <strong>{{ bank.bank_name }}</strong>
                        بنام
                        <strong>{{ bank.account_holder_name }}</strong>
                        واریز نمایید.
                    </p>
                    <p>شماره شبا: <strong>{{ bank.sheba_number }}</strong></p>
                    <p>شماره کارت: <strong>{{ bank.cart_number }}</strong></p>
                {% else %}
                    <p style="color: red;">اطلاعات حساب بانکی ثبت نشده است.</p>
                {% endif %}
            </td>
        </tr>
    </table>
</div>
{% endfor %}

</body>
</html>
